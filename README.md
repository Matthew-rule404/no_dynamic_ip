# no_dynamic_ip
Use Static IPv4 / IPv6 addresses with netplan. Set route information from DHCP server.

■開発環境
Ubuntu 24.04 LTSを対象に開発しています。
noble利用
netplanを利用する環境であれば同じものが動くと想定されます。
※debian/armbian環境のbookwormで利用する予定

■依存関係
YAML設定ファイルの内容を解析する際に利用
※パッケージインストールの場合バージョンが古い可能性が高いため公式gitインストール
yq　バージョン　v4.44.3を利用

IPアドレス関連の計算に利用
ipcalc

IP関連の操作に利用
iproute2

■プロジェクトの意図
固定IPv4/IPv6アドレスを利用しつつ、DHCPサーバーから情報を取得した経路情報などをを利用したい。

■現在のバージョンで実現・実装済みの機能
1.IPv4アドレスを固定アドレスで利用可能に
　/etc/netplan配下のYAML形式の設定ファイルで対応。
2.IPv6アドレスを固定アドレスで利用可能に
　/etc/netplan配下のYAML形式の設定ファイルで対応。
3.netplanで固定IPv4/IPv6アドレスを利用する場合に、
　自動的にDynamicアドレスが付与されるため、必要のないDynamicアドレスを削除する。
4.Dynamicアドレスを削除すると、そのアドレスに紐づく経路情報が削除されるため、
　Dynamicアドレスを削除する間に解析し、その経路情報を固定アドレスで利用可能な経路情報として再追加。
 IPv4/IPv6アドレスの違い
  IPv4:
  　デフォルト経路がダイナミックアドレスと関連して削除されるため
  　デフォルト経路をproto dhcpからproto kernelで利用できるように追加
  IPv6:
  　リンクローカルアドレスを利用したデフォルト経路の場合削除されない
  　グローバル用の経路情報が付与される場合については環境が整っていないため動作未検証
5.ロケール判定を実装
　日本語/英語両対応　※その他言語は未対応
6.単体実行時に実行確認機能
7.ドライランモード実装
8.デバッグモード実装
9.ログ取得機能実装

■実行方法
chmod +x no_dynamic‗ip.sh

■実行時の引数
 [-D|--debug [x]]  デバッグモード　xを付けるとラインモードを利用可能
 [-S|--silent]     サイレントモード
 [-DRY|--dry-run]  ドライランモード

■今後の予定
DHCPサーバーから取得できる各情報を保存する機能
　DNSサーバー情報の確認とダイナミックアドレス削除時の設定値保持
　SIPサーバー情報の確認とダイナミックアドレス削除時の設定値保持
ログローテート機能

